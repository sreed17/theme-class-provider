"use strict";var e=require("react"),r=require("immer");const t=e.createContext(null);function s(e){return!!Array.isArray(e)&&e.every((e=>"string"==typeof e))}function a(e){return!(!e||"object"!=typeof e)&&(null!=e&&"object"==typeof e&&"theme_classes"in e&&s(e.theme_classes)&&"current"in e&&function(e,r){return"number"==typeof e&&e>=0&&e<r}(e.current,e.theme_classes.length))}function n(e){try{localStorage.removeItem(e)}catch(e){console.error("Error clearing persisted theme data:",e)}}function o(e,r){return(e%r+r)%r}function c(e,t){return r.produce(e,(e=>{if(!function(e,r){switch(e){case"SET_CURRENT_THEME_CLASS":case"SET_DEFAULT":return"string"==typeof r;case"SET_LOADING_STATE":case"FLAG_PERSISTED_DATA_LOAD":return"boolean"==typeof r;case"SET_THEME_CLASSES":return s(r);case"TOGGLE_THEME":return null==r||void 0===r;case"LOAD_STATE":return a(r)}return!1}(t.type,t.payload)){const r=new Error("Type Error: Invalid ThemeClassAction type, Check the dispatched action object");return e.error=r,e}const r=t.type;switch(e.error=null,r){case"SET_LOADING_STATE":e.is_loading=t.payload;break;case"SET_THEME_CLASSES":if(0===t.payload.length){const r=new Error("Value Error: Theme-classes list must not be empty");return e.error=r,e}e.theme_classes=t.payload,e.previous=null,e.current=0;break;case"SET_CURRENT_THEME_CLASS":{const r=e.theme_classes.indexOf(t.payload);if(-1===r){const r=new Error("Invalid Value Error: Can't set to the proveded theme-class since it does not exist in the theme-classes list");e.error=r;break}e.previous=e.current,e.current=r;break}case"TOGGLE_THEME":{const r=e.theme_classes.length,t=e.current;e.previous=t;const s=t+1>=r?0:t+1;e.current=s;break}case"LOAD_STATE":{const{current:r,theme_classes:s}=t.payload;e.previous=null,e.current=r,e.theme_classes=s;break}case"SET_DEFAULT":{const r=e.theme_classes.indexOf(t.payload);if(-1===r){const r=new Error("Invalid Value Error: Can't set to the proveded theme-class since it does not exist in the theme-classes list");e.error=r;break}const s=[],a=e.theme_classes.length;for(let t=0;t<a;t++){const n=t-r,c=n<0?o(n,a):n;s[c]=e.theme_classes[t],t===e.previous&&(e.previous=c)}e.theme_classes=s,e.current=0;break}case"FLAG_PERSISTED_DATA_LOAD":e.loaded_persisted_data=t.payload}return e}))}const l={key:"theme-data",disabled:!1,clearOnUnload:!1},u=({themeClasses:r,children:s,persist:o,onChange:u,defaultTheme:i})=>{const d={...l,...o};if(0===r.length)throw new Error("Value Error: Theme-classes list must not be empty");const E={previous:null,current:0,is_loading:!0,theme_classes:r,error:null,loaded_persisted_data:!1},[h,_]=e.useReducer(c,E),m=e.useMemo((()=>({current:h.current,theme_classes:h.theme_classes})),[h.current,h.theme_classes]),T=e.useMemo((()=>d.key),[d.key]),p=e=>{_({type:"LOAD_STATE",payload:e})},y=e=>{_({type:"SET_DEFAULT",payload:e})};e.useEffect((()=>{const{key:e}=d,r=function(e){try{const r=localStorage.getItem(e);if(!r)return null;const t=JSON.parse(r);return a(t)?t:null}catch(e){return console.error("Error retrieving persisted theme data:",e),null}}(e);return r?(p(r),_({type:"FLAG_PERSISTED_DATA_LOAD",payload:!0})):null!=i&&y(i),(e=>{_({type:"SET_LOADING_STATE",payload:e})})(!1),()=>{(d.clearOnUnload||d.disabled)&&n(e)}}),[]),e.useEffect((()=>{h.is_loading||d.disabled||(!function(e,r){try{localStorage.setItem(e,JSON.stringify(r))}catch(e){console.error("Error setting persisted theme data:",e)}}(T,m),u&&u(h.current,h.previous,h.theme_classes))}),[h]);const S={is_loading:h.is_loading,error:h.error,loaded_persisted_data:h.loaded_persisted_data,setCurrentTheme:e=>{_({type:"SET_CURRENT_THEME_CLASS",payload:e})},getCurrentTheme:()=>h.theme_classes[h.current],toggleTheme:()=>{_({type:"TOGGLE_THEME",payload:void 0})},setThemeClasses:e=>{_({type:"SET_THEME_CLASSES",payload:e})},getThemeClasses:()=>h.theme_classes,loadState:p,clearPersistedThemeData:()=>{n(d.key)},setDefault:y};return e.createElement(t.Provider,{value:S},s)};u.defaultProps={persist:{},defaultTheme:null,onChange:function(e,r,t){try{if(null!==r){const e=t[r];document.documentElement.classList.remove(e)}const s=t[e];document.documentElement.classList.add(s)}catch(e){console.error("Error changing the document theme class")}}};exports.ThemeClassProvider=u,exports.useThemeClass=()=>{const r=e.useContext(t);if(!r)throw new Error("Error: Theme-class-context is null. Make sure the you are using the ThemeClassProvider correctly.");return r};
//# sourceMappingURL=index.js.map
